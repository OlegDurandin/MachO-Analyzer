# Анализ Mach-O файлов (MacOS X). 
### Финальный проект по курсе Reverse Engineering 
### Автор: Олег Дурандин (oleg.durandin@gmail.com)

## Постановка задачи
Разработать анализатор Mach-O файлов, с акцентом на Reverse-Engineer'ов и вирусных аналитиков.


Основные функции:
1. Базовый анализ заголовков
2. Просмотр секций и сегментов
3. Анализ импортов/экспортов
4. Детектирование встроенных данных
5. Поиск известных паттернов (anti-debugging, канарейки и т.д.)
6. Проверка механизмов безопасности
7. Проверка отладочной информации
8. Анализ обфускации
9. Анализ персистентности
10. Анализ сетевой активности
11. Анализ вредоносного ПО

## Структура проекта и общее описание

Проект имеет следующую структуру:

```tree
MachO-Analyzer/
├── src/        
│   ├── plugins/           # Плагины анализатора
│   │   ├── header_analyzer_plugin.py
│   │   ├── security_analyzer_plugin.py
│   │   ├── vulnerability_analyzer_plugin.py
│   │   ├── symbol_analyzer_plugin.py
│   │   ├── network_analyzer_plugin.py
│   │   ├── embedded_data_analyzer_plugin.py
│   │   ├── sign_analyzer_plugin.py
│   │   ├── permission_analyzer_plugin.py
│   │   ├── debug_analyzer_plugin.py
│   │   ├── obfuscation_analyzer_plugin.py
│   │   ├── persistence_analyzer_plugin.py
│   │   ├── malware_analyzer_plugin.py
│   │   └── malware_patterns_plugin.py            # Исходный код проекта
│   ├── core/              # Основные компоненты анализатора
│   │   ├── __init__.py
│   │   ├── header_analyzer.py    # Анализ заголовков Mach-O
│   │   ├── security_analyzer.py  # Анализ механизмов безопасности
│   │   ├── symbol_analyzer.py    # Анализ символов и импортов
│   │   ├── sign_analyzer.py      # Анализ подписей кода
│   │   ├── debug_analyzer.py     # Анализ отладочной информации
│   │   └── constants.py          # Константы и определения
|   |   └── plugin_base.py 
|   |   └── plugin_manager.py 
│   ├── utils/             # Вспомогательные утилиты
│   └── main.py            # Точка входа в программу
├── tests/                 # Тесты
├── requirements.txt       # Зависимости проекта
└── README.md             # Документация проекта
```

## Основные компоненты

Изначально структура проекта включала комплект анализаторов, в составе Mach-O Analyzer, однако, на основании обратной связи куратора архитектура была переработана с акцентом на расширяемость и добавление нового функционала посредством плагинов (plugins).

### 1. Плагины анализатора (src/plugins/)

#### header_analyzer_plugin.py
- Анализ заголовков Mach-O файлов
- Тип CPU и архитектура
- Флаги файла
- Сегменты и секции
- Версии и идентификаторы

#### security_analyzer_plugin.py
- Проверка механизмов безопасности
- ASLR (Address Space Layout Randomization)
- NX (Non-Executable Stack)
- Stack Canary
- RELRO (RELocation Read-Only)
- Safe Stack
- FORTIFY_SOURCE
- Подпись кода
- Анти-отладочные техники

#### vulnerability_analyzer_plugin.py
- Анализ уязвимых функций
- Проверка переполнения буфера
- Анализ строковых функций
- Проверка форматирования строк
- Анализ управления памятью

#### symbol_analyzer_plugin.py
- Анализ символов и импортов
- Глобальные символы
- Динамические библиотеки
- Импортируемые функции
- Экспортируемые символы

#### network_analyzer_plugin.py
- Анализ сетевой активности
- Сетевые функции
- HTTP/HTTPS операции
- DNS операции
- Сетевые протоколы

#### embedded_data_analyzer_plugin.py
- Анализ встроенных данных
- Строковые литералы
- Криптографические константы
- Чувствительные данные
- Ресурсы

#### sign_analyzer_plugin.py
- Анализ подписей кода
- Статус подписи
- Тип подписи
- Team ID
- Timestamp

#### permission_analyzer_plugin.py
- Анализ разрешений
- Права доступа
- Привилегии
- Ограничения
- Entitlements

#### debug_analyzer_plugin.py
- Анализ отладочной информации
- DWARF информация
- Отладочные символы
- UUID dSYM
- Отладочные маркеры

#### obfuscation_analyzer_plugin.py
- Анализ обфускации
- Методы обфускации
- Сложность анализа
- Уровень защиты
- Паттерны обфускации

#### persistence_analyzer_plugin.py
- Анализ персистентности
- Механизмы сохранения
- Автозапуск
- Регистрация
- Планировщик задач

#### malware_analyzer_plugin.py
- Анализ вредоносного ПО
- Известные паттерны
- Подозрительные функции
- Вредоносное поведение
- Классификация



### 2. Main (src/main.py)
- Точка входа в программу
- Обработка аргументов командной строки
- Координация работы анализаторов
- Форматирование результатов

## Технические детали

### Используемые библиотеки
- `macholib`: Основная библиотека для работы с Mach-O форматом
- `rich`: Форматирование вывода
- `dataclasses`: Для создания классов данных
- `enum`: Для определения перечислений
- `typing`: Для аннотаций типов


Этот анализ позволяет получить полную картину структуры Mach-O файла и его характеристик безопасности, что является важным этапом в процессе анализа безопасности приложения.

## Тестирование
- Модульные тесты для каждого плагина
- Тесты на различные типы файлов
- Проверка обработки ошибок


## Документация
- README.md содержит общее описание проекта
- Комментарии в коде объясняют сложные алгоритмы

## Требования к системе
- Python 3.6+
- macOS (для работы с Mach-O файлами)
- Установленные зависимости из requirements.txt

## Ограничения и известные проблемы
- Не все форматы Mach-O поддерживаются
- Некоторые проверки могут быть неточными
- Требуется доступ к исходному коду
- Ограничения на некоторые архитектуры

## Планы по улучшению
- Добавление новых проверок
- Улучшение точности анализа
- Расширение поддержки форматов
- Оптимизация производительности


В ходе дальнейшего изложения будут описаны ключевые пункты, касающиеся Mach-O файлов, их анализу в представленном анализаторе и вспомогательная информация, необходимая для понимания.

# Mach-O файлы
Mach-O (Mach Object) - это формат исполняемых файлов, используемый в ОС macOS и iOS. Этот формат был разработан для поддержки различных архитектур процессоров (x86_64, ARM64) и предоставляет гибкую структуру для хранения исполняемого кода, данных и метаданных.

## Структура Mach-O файла

Mach-O файл состоит из следующих основных компонентов:
1. Заголовок (Header)
* Содержит основную информацию о файле
* Определяет архитектуру и тип файла
* Указывает на расположение команд загрузки
2. Команды загрузки (Load Commands)
* Описывают как и где загружать различные части файла
* Определяют права доступа к сегментам
* Указывают на зависимости и символы
3. Данные (Data)
* Содержит исполняемый код
* Хранит данные программы
* Включает таблицы символов и строк

## Заголовок Mach-O файла
Заголовок Mach-O файла (Mach header) является первой структурой в файле и содержит основную информацию о формате и содержимом файла. Существует два варианта заголовка:

### Mach Header (32-bit)
Структура заголовка для 32-битных файлов содержит следующие поля:

```c
struct mach_header {
   uint32_t magic;
   cpu_type_t cputype;
   cpu_subtype_t cpusubtype;
   uint32_t filetype;
   uint32_t ncmds;
   uint32_t sizeofcmds;
   uint32_t flags;
};
```

- ``magic`` (uint32_t): Магическое число, идентифицирующее файл как Mach-O (``0xFEEDFACE``)
- ``cputype`` (cpu_type_t): Тип процессора (например, x86, ARM)
- ``cpusubtype`` (cpu_subtype_t): Подтип процессора
- ``filetype`` (uint32_t): Тип файла (исполняемый, библиотека и т.д.)
- ``ncmds`` (uint32_t): Количество команд загрузки
- ``sizeofcmds`` (uint32_t): Общий размер всех команд загрузки
- ``flags`` (uint32_t): Флаги, определяющие различные характеристики файла

### Mach Header 64 (64-bit)
Для 64-битных файлов структура расширена и включает дополнительное поле:


```c
struct mach_header_64 {
   uint32_t magic;
   cpu_type_t cputype;
   cpu_subtype_t cpusubtype;
   uint32_t filetype;
   uint32_t ncmds;
   uint32_t sizeofcmds;
   uint32_t flags;
   uint32_t reserved;
};
```

- ``magic`` (uint32_t): Магическое число для 64-bit (0xFEEDFACF)
- ``cputype`` (cpu_type_t): Тип процессора
- ``cpusubtype`` (cpu_subtype_t): Подтип процессора  
- ``filetype`` (uint32_t): Тип файла
- ``ncmds`` (uint32_t): Количество команд загрузки
- ``sizeofcmds`` (uint32_t): Общий размер команд
- ``flags`` (uint32_t): Флаги файла
- ``reserved`` (uint32_t): Зарезервированное поле (добавлено для 64-bit)


Полная спецификация, относительно ABI формата Mach-O файла в OS X может бы ть найдена по ссылке:
Link: https://github.com/aidansteele/osx-abi-macho-file-format-reference 


### Запуск анализатора

#### 1. Базовый анализ
```bash
python3 src/main.py /path/to/binary
```

#### 2. Анализ с выводом в файл
```bash
python3 src/main.py /path/to/binary > report.txt 
```

В выходном файле (см. примеры вывода в директории results) выводится информация в следующем порядке:

1. Заголовок и основная информация о сегментах (результат работы плагина ``header_analyzer_plugin.py`` )
2. Информация о механизмах безопасности, обнаруженных в Mach-O файле (результат работы плагина ``security_analyzer_plugin.py``)
3. Информация о потенциальных уязвимостях (``vulnerability_analyzer_plugin.py``)
4. Информация о символах и импортах (``symbol_analyzer_plugin.py``)
5. Информация функциях, связанных с сетевой активности (``network_analyzer_plugin.py``)
6. Анализатор данных, встроенных в бинарный файл, и представляющих потенциальный интерес для реверс-инженера (``embedded_data_analyzer_plugin.py``)
7. Анализатор подписей (механизм в OS X) - ``sign_analyzer_plugin.py``
8. Анализатор разрешений, запрашиваемых файлом - ``permission_analyzer_plugin.py``
9. Анализатор отладочной информации ``debug_analyzer_plugin.py``
10. Анализвтор обфускации файла ``obfuscation_analyzer_plugin.py``
11. Анализ механизмов персистентности ``persistence_analyzer_plugin.py``

Все плагины располагаются в папке ``/src/plugins/*_plugin.py`` и имеют интерфейс, реализующий абстрактный класс ``/src/core/plugin_base.py``.

Далее, описаны каждый из плагинов с сопутствующим функционалом.

## Плагины для Mach-O Analyzer
Механизм плагинов имлементирован для боле легкой расширяемости приложения.
Таким образом, посредством плагинов каждый пользователь может добавить требуемый ему функционал.

### Абстрактный класс MachOPlugin 
Расположен в ``/src/core/plugin_base.py``


```python
class MachOPlugin(ABC):
    """Базовый класс для всех плагинов анализатора Mach-O"""
    
    def __init__(self, macho: MachO, file_path: str):
        self.macho = macho
        self.file_path = file_path
    
    @abstractmethod
    def analyze(self) -> Dict[str, Any]:
        """Основной метод анализа. Должен возвращать словарь с результатами"""
        pass
    
    @staticmethod
    @abstractmethod
    def get_name() -> str:
        """Возвращает имя плагина"""
        pass
    
    @staticmethod
    @abstractmethod
    def get_description() -> str:
        """Возвращает описание функционала плагина"""
        pass
    
    @staticmethod
    @abstractmethod
    def get_version() -> str:
        """Возвращает версию плагина"""
        pass
    
    def get_dependencies(self) -> List[str]:
        """Возвращает список зависимостей плагина"""
        return []
    
    def is_compatible(self) -> bool:
        """Проверяет совместимость плагина с текущим файлом"""
        return True 
```

Каждый плагин должен отнаследоваться от базового класса и имплементировать абстрактные методы.


### Плагин анализа заголовка ``header_analyzer_plugin.py``

Анализатор заголовков является ключевым компонентом Mach-O Analyzer, который предоставляет детальную информацию о структуре и характеристиках Mach-O файла. Этот анализатор необходим для понимания базовой архитектуры файла и его совместимости с целевой системой.

#### Основной функционал ``header_analyzer_plugin.py``

1. **Анализ базовой информации**
   - Magic number (идентификатор формата файла)
   - Битность (32/64-bit)
   - Тип CPU и подтип
   - Тип файла (исполняемый, библиотека и т.д.)
   - Количество и размер команд загрузки
   - Размер файла
   - Дата модификации

2. **Анализ версий и идентификаторов**

В Mach-O файлах хранится важная информация о версиях и идентификаторах, которая помогает отслеживать совместимость и отладку:

   - UUID файла (уникальный идентификатор)
      - Используется для свзяывания исполняемого файла с его отладочными символами (dSYM) - например, отладчики используют UUID для корректной привязки отладочных символов к исполняемому файлу 
      - При динамическом анализе UUID позволяет идентифицировать версию бинарного файла
      - В FAT файлах каждая архитектура имеет свой уникальный UUID
   - Минимальная версия OS
      - Формат: `MAJOR.MINOR.PATCH` (Пример: `10.13.0`)
      - Показывает минимальную версию macOS, требуемую для запуска файла
      - Важно для:
         - Определения совместимости с целевой системой
         - Проверки доступности API и функций
         - Отладки проблем, связанных с версиями ОС
         - Планирования поддержки старых версий
   - Версия SDK
      - Формат: `MAJOR.MINOR.PATCH`
      - Указывает версию SDK, использованного при компиляции
      - Полезно для:
         - Отслеживания используемых API и функций
         - Определения доступных возможностей
         - Проверки совместимости с целевой системой
         - Отладки проблем, связанных с SDK
   - Версия исходного кода
      - Формат: `MAJOR.MINOR.PATCH.BUILD` (Пример: `7619.1.26.31.7`)
      - Показывает версию исходного кода, из которого был собран файл
      - Полезно для:
         - Отслеживания изменений в коде
         - Определения совместимости версий
         - Связывания с конкретными коммитами в системе контроля версий
         - Отладки проблем, связанных с конкретными версиями кода
   - Версия сборки
      - Формат: `MAJOR.MINOR`
      - Указывает версию операционной системы, для которой была создана сборка
      - Важно для:
         - Определения минимальной версии macOS, требуемой для запуска
         - Проверки совместимости с целевой системой
         - Отладки проблем, связанных с версиями ОС
         - Планирования обновлений и поддержки


3. **Анализ флагов**
   - ``MH_NOUNDEFS`` (отсутствие неопределенных символов)
   - ``MH_DYLDLINK`` (динамическая линковка)
      - Загрузка библиотек во время выполнения, что уменьшает размер файла
   - ``MH_TWOLEVEL`` (двухуровневое пространство имен)
      - Предотвращает кофнликт имен и обеспечивает изоляцию между модулями
   - ``MH_PIE`` (Position Independent Executable)
      - Включена поддержка ASLR
      - Усложняет атаки на переполнение буфера
   - ``MH_NO_HEAP_EXECUTION`` (запрет выполнения в куче)
      - Улучшает защиту от heap-spray атак
      - Предотвращает выполнение shellcode в куче
   - ``MH_ALLOW_STACK_EXECUTION`` 
      - Разрешение выполнения кода в стеке
      - Потенциально опасный флаг (рекомендуется отключить для безопасности)
   - ``MH_ROOT_SAFE`` (Безопасность при запуске от root)
      - Ограничение привелегий
      - Обеспечивает защиту от повышения привилегий

4. **Анализ сегментов**
   - Имя сегмента
   - Виртуальный адрес (``VMAddr``)
   - Размер в памяти (``VMSize``)
   - Смещение в файле (`FileOff`)
   - Размер в файле (`FileSize`)
   - Права доступа (`maxprot`, `initprot`)
   - Количество секций

Сегменты в Mach-O файле представляют собой логические разделы памяти, каждый со своими правами доступа и назначением. Для анализа вредоносного ПО особое внимание следует уделять следующим аспектам:

#### Основные сегменты и их анализ
- **`__TEXT`**
  - Содержит исполняемый код
  - Должен иметь права R-X (чтение и выполнение)
  - Подозрительные признаки:
    - Права RWX (чтение, запись, выполнение)
    - Необычно большой размер
    - Нестандартное смещение

- **`__DATA`**
  - Содержит инициализированные данные
  - Типичные права RW- (чтение и запись)
  - Подозрительные признаки:
    - Права на выполнение (X)
    - Необычно большой размер
    - Скрытые данные в неиспользуемых областях

- **`__BSS`**
  - Неинициализированные данные
  - Права RW- (чтение и запись)
  - Подозрительные признаки:
    - Необычно большой размер
    - Права на выполнение
    - Скрытые данные

- **`__LINKEDIT`**
  - Содержит информацию о линковке
  - Типичные права R-- (только чтение)
  - Подозрительные признаки:
    - Права на запись
    - Нестандартное содержимое
    - Скрытые строки или данные

#### Критические параметры для анализа
- **Виртуальный адрес (VMAddr)**
  - Начальный адрес сегмента в памяти
  - Подозрительные признаки:
    - Нестандартные адреса
    - Перекрытие с другими сегментами
    - Адреса в системных областях

- **Размер в памяти (VMSize)**
  - Размер сегмента при загрузке
  - Подозрительные признаки:
    - Несоответствие с FileSize
    - Необычно большой размер
    - Размер, не кратный странице памяти

- **Смещение в файле (FileOff)**
  - Позиция сегмента в файле
  - Подозрительные признаки:
    - Нестандартное выравнивание
    - Перекрытие с другими сегментами
    - Скрытые данные между сегментами

- **Размер в файле (FileSize)**
  - Размер сегмента в файле
  - Подозрительные признаки:
    - Несоответствие с VMSize
    - Необычно маленький размер
    - Размер, не кратный странице

- **Права доступа**
  - maxprot: максимальные права
  - initprot: начальные права
  - Подозрительные признаки:
    - Права RWX в любом сегменте
    - Нестандартные комбинации прав
    - Изменение прав во время выполнения



5. **Анализ секций**

Секции являются подразделениями сегментов и содержат конкретные типы данных. Плагин выделет следующие аспекты


   - Имя секции
   - Адрес
   - Размер
   - Флаги атрибутов:
     - PURE_INSTRUCTIONS (чистый код)
     - NO_TOC (отсутствие таблицы содержания)
     - STRIP_STATIC_SYMS (удаление статических символов)
     - NO_DEAD_STRIP (сохранение неиспользуемого кода)
     - LIVE_SUPPORT (поддержка живых символов)
     - SELF_MODIFYING_CODE (самомодифицирующийся код - потенциально опасный признак, усложняет статический анализ и возможна обфускация)
     - DEBUG (отладочная информация)
     - SOME_INSTRUCTIONS (смешанный код)
     - EXT_RELOC (внешние перемещения)
     - LOC_RELOC (локальные перемещения)


#### Применение

Анализатор заголовков используется для:

1. **Определения совместимости**
   - Проверка архитектуры (x86_64, arm64)
   - Проверка минимальной версии OS
   - Проверка типа файла

2. **Анализа безопасности**
   - Проверка флагов защиты (PIE, NX)
   - Анализ прав доступа к сегментам
   - Проверка механизмов безопасности

3. **Отладки и анализа**
   - Поиск отладочной информации
   - Анализ структуры памяти
   - Проверка символов и перемещений

4. **Оптимизации**
   - Анализ размера файла
   - Проверка неиспользуемого кода
   - Оптимизация загрузки

#### Рекомендации по безопасности

Анализатор предоставляет рекомендации по улучшению безопасности:

1. **Критические рекомендации**
   - Включение PIE для ASLR
   - Запрет выполнения в куче
   - Правильная настройка прав доступа

2. **Оптимизация**
   - Удаление неиспользуемого кода
   - Оптимизация размера файла
   - Улучшение производительности

3. **Совместимость**
   - Проверка версий OS
   - Поддержка архитектур
   - Корректная линковка

#### Вывод результатов 

Ниже приведен пример вывода для приложения [Telegram](https://telegram.org/)

```

Основная информация
┏━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Параметр          ┃ Значение                       ┃
┡━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Magic             │ 0xfeedfacf (MH_MAGIC_64)       │
│ Битность          │ 64-bit                         │
│ CPU Type          │ x86_64                         │
│ CPU Subtype       │ All                            │
│ Тип файла         │ Executable                     │
│ Количество команд │ 109                            │
│ Размер команд     │ 12272                          │
│ Размер файла      │ 170789.28 Kb (174888224 bytes) │
│ Дата модификации  │ 2025-03-26 17:27:54            │
└───────────────────┴────────────────────────────────┘

Версии и идентификаторы
┏━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Параметр       ┃ Значение                         ┃
┡━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Uuid           │ c4a3a9bbaa0d3f23a83b304db6375e48 │
│ Min Os Version │ 10.13.0                          │
│ Sdk Version    │ 14.0.0                           │
│ Source Version │ 0.0.0.0.0                        │
└────────────────┴──────────────────────────────────┘

Флаги
┏━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Флаг                   ┃ Описание                                  ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ MH_NOUNDEFS            │ Не содержит неопределенных символов       │
│ MH_DYLDLINK            │ Динамически связанный                     │
│ MH_TWOLEVEL            │ Двухуровневое пространство имен           │
│ MH_WEAK_DEFINES        │ Слабые определения                        │
│ MH_BINDS_TO_WEAK       │ Связывается со слабыми символами          │
│ MH_PIE                 │ Position Independent Executable           │
│ MH_HAS_TLV_DESCRIPTORS │ Содержит дескрипторы Thread Local Storage │
└────────────────────────┴───────────────────────────────────────────┘

Сегменты
┏━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━┓
┃ Имя        ┃ VMAddr      ┃ VMSize      ┃ FileOff   ┃ FileSize  ┃ Защита            ┃ NSects ┃
┡━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━┩
│ __PAGEZERO │ 0x0         │ 0x100000000 │ 0x0       │ 0x0       │ max=---, init=--- │ 0      │
│ __TEXT     │ 0x100000000 │ 0x4d98000   │ 0x0       │ 0x4d98000 │ max=R-X, init=R-X │ 25     │
│ __DATA     │ 0x104d98000 │ 0x18d8000   │ 0x4d98000 │ 0x72c000  │ max=RW-, init=RW- │ 29     │
│ __LINKEDIT │ 0x106670000 │ 0x4a4000    │ 0x54c4000 │ 0x4a2bb0  │ max=R--, init=R-- │ 0      │
└────────────┴─────────────┴─────────────┴───────────┴───────────┴───────────────────┴────────┘

Секции в __TEXT
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Имя              ┃ Адрес       ┃ Размер   ┃ Флаги                                ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ __text           │ 0x100007000 │ 73893769 │ PURE_INSTRUCTIONS, SOME_INSTRUCTIONS │
│ __stubs          │ 0x10467f78a │ 13908    │ PURE_INSTRUCTIONS, SOME_INSTRUCTIONS │
│ __stub_helper    │ 0x104682de0 │ 22696    │ PURE_INSTRUCTIONS, SOME_INSTRUCTIONS │
│ __const          │ 0x104688700 │ 2107592  │ -                                    │
│ __objc_methname  │ 0x10488afc8 │ 248304   │ -                                    │
│ __swift5_typeref │ 0x1048c79b8 │ 363955   │ -                                    │
│ __cstring        │ 0x104920770 │ 1890859  │ -                                    │
│ __constg_swiftt  │ 0x104aee19c │ 534696   │ -                                    │
│ __swift5_proto   │ 0x104b70a44 │ 34228    │ -                                    │
│ __swift5_types   │ 0x104b78ff8 │ 31548    │ -                                    │
│ __swift5_protos  │ 0x104b80b34 │ 704      │ -                                    │
│ __swift5_entry   │ 0x104b80df4 │ 8        │ -                                    │
│ __swift5_fieldmd │ 0x104b80dfc │ 294744   │ -                                    │
│ __swift5_builtin │ 0x104bc8d54 │ 12080    │ -                                    │
│ __swift5_reflstr │ 0x104bcbc90 │ 265102   │ -                                    │
│ __swift5_assocty │ 0x104c0c820 │ 20152    │ -                                    │
│ __swift5_capture │ 0x104c116d8 │ 266172   │ -                                    │
│ __swift5_mpenum  │ 0x104c52694 │ 16708    │ -                                    │
│ __gcc_except_tab │ 0x104c567d8 │ 341628   │ -                                    │
│ __objc_classname │ 0x104ca9e54 │ 18207    │ -                                    │
│ __objc_methtype  │ 0x104cae573 │ 82416    │ -                                    │
│ __ustring        │ 0x104cc2764 │ 3922     │ -                                    │
│ __ms_ios         │ 0x104cc36b6 │ 97       │ -                                    │
│ __unwind_info    │ 0x104cc3718 │ 654724   │ -                                    │
│ __eh_frame       │ 0x104d634a0 │ 212256   │ -                                    │
└──────────────────┴─────────────┴──────────┴──────────────────────────────────────┘

```


### Плагин анализа безопасности ``security_analyzer_plugin.py``

Плагин анализа безопасности является критически важным компонентом Mach-O Analyzer, который предоставляет комплексный анализ защитных механизмов и потенциальных уязвимостей в Mach-O файлах. Этот анализатор необходим для оценки уровня безопасности приложения и выявления потенциальных проблем.

#### Основной функционал ``security_analyzer_plugin.py``


1. **Анализ базовой информации**
   - Общее количество проблем безопасности
   - Количество критических проблем
   - Количество предупреждений
   - Количество информационных сообщений
   - Общий уровень риска

2. **Анализ механизмов защиты**

   - **ASLR (Address Space Layout Randomization)**
     - Проверка флага MH_PIE
     - Анализ рандомизации адресного пространства
     - Оценка эффективности защиты от атак на переполнение буфера

   - **NX (Non-Executable Stack)**
     - Проверка прав доступа к сегментам  (производит анализ исполняемых секций)
     - Защита от выполнения кода в стеке
     - Проверка сегмента данных на исполняемость

   - **RELRO (RELocation Read-Only)**
     - Проверка защиты GOT (Global Offset Table)
     - Анализ прав доступа к сегментам
     - Защита от перезаписи таблицы перемещений
     - Оценка эффективности защиты

   - **Stack Canary**
     - Поиск канареек в стеке
     - Анализ механизмов защиты от переполнения
     - Проверка реализации канареек
     - Оценка надежности защиты

   - **Safe Stack**
     - Проверка наличия безопасного стека
     - Анализ реализации на x86_64 (для ARM64 неактуально)
     - Рекомендации по использованию

   - **FORTIFY_SOURCE**
     - Проверка защищенных функций
     - Анализ использования безопасных версий
     - Защита от переполнения буфера

3. **Анализ подписи кода**
   - Проверка наличия подписи 
   - Верификация подписи (используется системная утилита Mac ``codesign``)
   - Анализ сертификатов (используется системная утилита Mac ``codesign``)
   - Проверка целостности (используется системная утилита Mac ``codesign``)

4. **Анализ шифрования**
   - Проверка наличия шифрования
   - Анализ механизмов шифрования
   - Оценка эффективности защиты
   - Рекомендации по улучшению

5. **Анализ символов и импортов**
   - Проверка слабых символов
   - Анализ неопределенных символов
   - Проверка импортов
   - Оценка рисков

6. **Анализ сетевой активности**
   - Поиск сетевых функций
   - Анализ протоколов
   - Проверка безопасности
   - Рекомендации по защите

7. **Анализ отладочной информации**
   - Проверка отладочных символов
   - Анализ DWARF информации
   - Оценка рисков утечки информации
   - Рекомендации по защите

8. **Анализ уязвимых функций**
   - Поиск небезопасных функций
   - Анализ использования
   - Оценка рисков
   - Рекомендации по замене

9. **Анализ антиотладочных техник**
   - Поиск антиотладочных функций
   - Анализ механизмов защиты
   - Оценка эффективности
   - Рекомендации по улучшению

#### Уровни риска

Анализатор использует три уровня риска для классификации проблем:

1. **INFO**
   - Информационные сообщения
   - Не критичные проблемы
   - Рекомендации по улучшению

2. **WARNING**
   - Предупреждения
   - Потенциальные проблемы
   - Требуют внимания

3. **CRITICAL**
   - Критические проблемы
   - Требуют немедленного исправления
   - Серьезные уязвимости

#### Рекомендации по безопасности

Анализатор предоставляет рекомендации по улучшению безопасности:

1. **Критические рекомендации**
   - Включение ASLR
   - Запрет выполнения в стеке
   - Правильная настройка прав доступа
   - Использование безопасных функций

2. **Оптимизация защиты**
   - Улучшение механизмов защиты
   - Оптимизация производительности
   - Улучшение безопасности

3. **Совместимость**
   - Проверка версий OS
   - Поддержка архитектур
   - Корректная линковка

#### Вывод результатов

Ниже приведен пример вывода для приложения:

```
Основная информация о безопасности
┏━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Параметр       ┃ Значение              ┃
┡━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━┩
│ Всего проблем  │ 8                     │
│ Критических    │ 0                     │
│ Предупреждений │ 8                     │
│ Информационных │ 0                     │
│ Уровень риска  │ SeverityLevel.WARNING │
└────────────────┴───────────────────────┘

Флаги заголовка
┏━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Флаг              ┃ Статус   ┃ Уровень ┃ Описание                                           ┃ Рекомендация                                                           ┃
┡━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Reexported Dylibs │ Отключен │ WARNING │ Разрешено реэкспортирование динамических библиотек │ Ограничить реэкспортирование библиотек для предотвращения DLL-инъекций │
│ Relro             │ Отключен │ WARNING │ Отключен RELRO                                     │ Включить RELRO при компиляции                                          │
└───────────────────┴──────────┴─────────┴────────────────────────────────────────────────────┴────────────────────────────────────────────────────────────────────────┘

Исполняемые секции
┏━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Имя           ┃ Флаги      ┃ Рекомендация                               ┃
┡━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ __text        │ 2147484672 │ Проверить необходимость исполняемых секций │
│ __stubs       │ 2147484680 │ Проверить необходимость исполняемых секций │
│ __stub_helper │ 2147484672 │ Проверить необходимость исполняемых секций │
└───────────────┴────────────┴────────────────────────────────────────────┘

Оценка рисков
┏━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Уровень               ┃ Причины                                               ┃ Рекомендации                                                      ┃
┡━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ SeverityLevel.WARNING │ Обнаружено значительное количество предупреждений (8) │ Рекомендуется исправить предупреждения для улучшения безопасности │
└───────────────────────┴───────────────────────────────────────────────────────┴───────────────────────────────────────────────────────────────────┘
```


### Плагин поиска потенциальных уязвимостей ``vulnerability_analyzer_plugin.py``

Плагин анализа уязвимостей является важным компонентом Mach-O Analyzer, который специализируется на выявлении потенциальных уязвимостей и точек инъекции в Mach-O файлах. Этот анализатор необходим для оценки безопасности приложения и выявления потенциальных проблем.

#### Основной функционал ``vulnerability_analyzer_plugin.py``

1. **Анализ базовой информации**
   - Общее количество уязвимостей
   - Количество критических уязвимостей
   - Количество предупреждений
   - Количество информационных сообщений
   - Общий уровень риска

2. **Анализ небезопасных функций**

   - **Переполнение буфера**
     - strcpy, strcat, gets
     - sprintf, vsprintf
     - scanf, fscanf, sscanf
     - realpath, syslog
     - Другие небезопасные функции

   - **Форматирование строк**
     - printf, fprintf
     - sprintf, snprintf
     - vprintf, vfprintf
     - vsprintf, vsnprintf

   - **Инъекция команд**
     - system, popen
     - execl, execlp
     - execle, execv
     - execvp, execvpe

   - **Коррупция памяти**
     - memcpy, memmove
     - memset, malloc
     - free, realloc
     - alloca

3. **Анализ точек инъекции**

   - **DYLD инъекции**
     - DYLD_INSERT_LIBRARIES
     - DYLD_LIBRARY_PATH
     - DYLD_FRAMEWORK_PATH
     - DYLD_FORCE_FLAT_NAMESPACE

   - **Runtime инъекции**
     - dlopen, dlsym
     - dyld_image_path_containing_address
     - _dyld_get_image_name
     - _dyld_register_func_for_add_image

   - **Инъекции процесса**
     - task_for_pid
     - mach_vm_allocate
     - mach_vm_write
     - mach_vm_protect
     - thread_create
     - thread_set_state

   - **Хуки**
     - ptrace
     - mach_msg
     - interceptor_begin
     - method_exchangeImplementations
     - method_setImplementation

4. **Анализ уязвимых конфигураций**

   - **Флаги безопасности**
     - _FORTIFY_SOURCE
     - stack_chk_guard
     - stack_chk_fail
     - fstack-protector
     - allow_stack_execute
     - restricted
     - ASLR

   - **Отладочные маркеры**
     - PT_DENY_ATTACH
     - sysctl
     - ptrace
     - isatty
     - ioctl
     - ttyname

5. **Специальные проверки**

   - **Защита стека**
     - Проверка флага NX_STACK
     - Анализ прав доступа
     - Оценка эффективности защиты


#### Уровни риска

Анализатор использует три уровня риска для классификации уязвимостей:

1. **INFO**
   - Информационные сообщения
   - Не критичные проблемы
   - Рекомендации по улучшению

2. **WARNING**
   - Предупреждения 
   - Потенциальные проблемы
   - Требуют внимания
      - Исполняемые секции
      - Потенциальная уязвимость повреждения памяти
      - Наличие точек инъекции runtime или наличие точек хука.
      - Уязвимые конфигурации безопасности 
      - Наличие отладочных маркеров 


3. **CRITICAL**
   - Критические уязвимости 
   - Требуют немедленного исправления
   - Серьезные проблемы безопасности
      - Разрешено выполнение кода в стеке/куче
      - Отключен ASLR
      - Наличие функций, с уязвимостью переполнения буфера, уязвимостями форматирования строк или инъекции команд
      - Точки инъекции DYLD


#### Вывод результатов

```
Основная информация о потенциальныхуязвимостях
┏━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━┓
┃ Параметр          ┃ Значение ┃
┡━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━┩
│ Всего уязвимостей │ 12       │
│ Критических       │ 3        │
│ Предупреждений    │ 9        │
│ Информационных    │ 0        │
└───────────────────┴──────────┘

Флаги заголовка
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Описание                                           ┃ Уровень ┃ Детали                                                       ┃ Рекомендация                                                           ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Разрешено реэкспортирование динамических библиотек │ WARNING │ Флаг MH_NO_REEXPORTED_DYLIBS не установлен в заголовке файла │ Ограничить реэкспортирование библиотек для предотвращения DLL-инъекций │
└────────────────────────────────────────────────────┴─────────┴──────────────────────────────────────────────────────────────┴────────────────────────────────────────────────────────────────────────┘

Исполняемые секции
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Описание                                 ┃ Уровень ┃ Детали                                                   ┃ Рекомендация                               ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Найдена исполняемая секция __text        │ WARNING │ Секция __text имеет флаг S_ATTR_SOME_INSTRUCTIONS        │ Проверить необходимость исполняемых секций │
│ Найдена исполняемая секция __stubs       │ WARNING │ Секция __stubs имеет флаг S_ATTR_SOME_INSTRUCTIONS       │ Проверить необходимость исполняемых секций │
│ Найдена исполняемая секция __stub_helper │ WARNING │ Секция __stub_helper имеет флаг S_ATTR_SOME_INSTRUCTIONS │ Проверить необходимость исполняемых секций │
└──────────────────────────────────────────┴─────────┴──────────────────────────────────────────────────────────┴────────────────────────────────────────────┘

Небезопасные функции
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Описание                                ┃ Уровень  ┃ Детали                                  ┃ Рекомендация                                ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Найдена уязвимость переполнения буфера  │ CRITICAL │ Обнаружена небезопасная функция strcpy  │ Проверить обработку входных данных          │
│ Найдена уязвимость переполнения буфера  │ CRITICAL │ Обнаружена небезопасная функция strcat  │ Проверить обработку входных данных          │
│ Возможная уязвимость инъекции команд    │ CRITICAL │ Обнаружена небезопасная функция system  │ Проверить обработку пользовательского ввода │
│ Возможная уязвимость повреждения памяти │ WARNING  │ Обнаружена небезопасная функция memcpy  │ Проверить управление памятью                │
│ Возможная уязвимость повреждения памяти │ WARNING  │ Обнаружена небезопасная функция memmove │ Проверить управление памятью                │
│ Возможная уязвимость повреждения памяти │ WARNING  │ Обнаружена небезопасная функция memset  │ Проверить управление памятью                │
│ Возможная уязвимость повреждения памяти │ WARNING  │ Обнаружена небезопасная функция free    │ Проверить управление памятью                │
│ Возможная уязвимость повреждения памяти │ WARNING  │ Обнаружена небезопасная функция alloca  │ Проверить управление памятью                │
└─────────────────────────────────────────┴──────────┴─────────────────────────────────────────┴─────────────────────────────────────────────┘

Оценка рисков
┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Уровень  ┃ Причины                               ┃ Рекомендации                                ┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ CRITICAL │ Обнаружены критические уязвимости (3) │ Немедленно исправить критические уязвимости │
└──────────┴───────────────────────────────────────┴─────────────────────────────────────────────┘
```

### Плагин анализа символов ``symbol_analyzer_plugin.py``

Плагин анализа символов является компонентом Mach-O Analyzer, который специализируется на анализе символов и динамических библиотек в Mach-O файлах. Этот анализатор необходим для понимания структуры приложения, его зависимостей и потенциальных проблем безопасности.

#### Теоретическая часть

##### Символы в Mach-O файлах

Символы в Mach-O файлах представляют собой именованные ссылки на функции, переменные и другие элементы программы. Они играют важную роль в:

1. **Линковке**
   - Разрешение внешних зависимостей
   - Связывание объектных файлов
   - Динамическая загрузка библиотек

2. **Отладке**
   - Связывание с отладочными символами
   - Поиск исходного кода
   - Анализ стека вызовов

3. **Безопасности**
   - Проверка целостности
   - Анализ экспортируемых функций
   - Обнаружение вредоносного кода

##### Типы символов

1. **Локальные символы**
   - Видимы только внутри файла
   - Не экспортируются
   - Используются для внутренних ссылок

2. **Глобальные символы**
   - Видимы во всех файлах
   - Могут быть экспортированы
   - Используются для внешних ссылок

3. **Слабые символы**
   - Могут быть переопределены
   - Используются для плагинов
   - Позволяют переопределение

4. **Неопределенные символы**
   - Требуют разрешения
   - Ссылаются на внешние определения
   - Загружаются динамически

##### Динамические библиотеки

1. **Системные библиотеки**
   - Расположены в системных директориях
   - Предоставляют базовый функционал
   - Требуют проверки версий

2. **Пользовательские библиотеки**
   - Создаются разработчиками
   - Могут быть приватными
   - Требуют проверки безопасности

3. **Слабые библиотеки**
   - Могут отсутствовать
   - Используются для опционального функционала
   - Требуют проверки наличия

#### Основной функционал ``symbol_analyzer_plugin.py``

1. **Анализ базовой информации**
   - Общее количество символов
   - Количество глобальных символов
   - Количество локальных символов
   - Количество неопределенных символов
   - Количество слабых символов
   - Количество экспортируемых символов

2. **Анализ символов**

   - **Типы символов**
     - Локальные
     - Глобальные
     - Слабые
     - Неопределенные
     - Неизвестные

   - **Атрибуты символов**
     - Имя
     - Тип
     - Секция
     - Адрес
     - Флаги

   - **Флаги символов**
     - Weak (слабый)
     - Undefined (неопределенный)
     - Exported (экспортируемый)
     - Private (приватный)
     - Resolver (резолвер)

3. **Анализ библиотек**

   - **Типы библиотек**
     - Системные
     - Пользовательские
     - Приватные
     - Слабые
     - Реэкспортируемые

   - **Атрибуты библиотек**
     - Имя
     - Путь
     - Тип
     - Флаги

   - **Флаги библиотек**
     - Weak (слабая)
     - Reexported (реэкспортируемая)
     - Private (приватная)
     - System (системная)

4. **Специальные проверки**

   - **Безопасность**
     - Проверка приватных символов
     - Анализ экспортируемых функций
     - Проверка слабых символов

   - **Зависимости**
     - Анализ системных библиотек
     - Проверка версий
     - Поиск конфликтов

   - **Оптимизация**
     - Анализ неиспользуемых символов
     - Проверка дубликатов
     - Оценка размера

#### Вывод результатов

Ниже приведен пример вывода для приложения:

```
Основная информация о символах и библиотеках
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━┓
┃ Параметр         ┃ Значение ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━┩
│ Всего символов   │ 4610     │
│ Глобальных       │ 3585     │
│ Локальных        │ 434      │
│ Неопределенных   │ 0        │
│ Слабых           │ 0        │
│ Экспортируемых   │ 3585     │
│ Всего библиотек  │ 92       │
│ Системных        │ 64       │
│ Приватных        │ 28       │
│ Слабых           │ 32       │
│ Реэкспортируемых │ 0        │
└──────────────────┴──────────┘

Символы
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━┓
┃ Имя                                                                                                                                                                                              ┃ Тип     ┃ Секция ┃ Адрес           ┃ Флаги    ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━┩
│                                                                                                                                                                                                  │ Unknown │ N/A    │ 0x40014021ff994 │ N/A      │
│                                                                                                                                                                                                  │ Unknown │ N/A    │ 0x4002802201a78 │ N/A      │
│                                                                                                                                                                                                  │ Unknown │ N/A    │ 0x4002002203034 │ N/A      │
│                                                                                                                                                                                                  │ Local   │ N/A    │ 0x4002402208dd4 │ N/A      │
│                                                                                                                                                                                                  │ Unknown │ N/A    │ 0x400280220a588 │ N/A      │
│                                                                                                                                                                                                  │ Local   │ N/A    │ 0x4002002210e20 │ N/A      │
│                                                                                                                                                                                                  │ Local   │ N/A    │ 0x40038022131e0 │ N/A      │
│                                                                                                                                                                                                  │ Unknown │ N/A    │ 0x4002802215178 │ N/A      │
│                                                                                                                                                                                                  │ Local   │ N/A    │ 0x4001c02216dcc │ N/A      │
│                                                                                                                                                                                                  │ Unknown │ N/A    │ 0x4002802219b08 │ N/A      │
│                                                                                                                                                                                                  │ Unknown │ N/A    │ 0x400280221a854 │ N/A      │
│                                                                                                                                                                                                  │ Unknown │ N/A    │ 0x400280221b198 │ N/A      │
│                                                                                                                                                                                                  │ Unknown │ N/A    │ 0x400280221fbe8 │ N/A      │
...
│ detail_50021cpp_regex_traits_baseIcEENS1_31cpp_regex_traits_implementationIcEEE6do_getERKS3_mE6s_data                                                                                            │ Global  │ N/A    │ 0x104f19e20     │ Exported │
...
│ aitsIcEEEEE10match_failEv                                                                                                                                                                        │ Global  │ N/A    │ 0x104f1e3c8     │ Exported │
...
│ enerator                                                                                                                                                                                         │ Global  │ N/A    │ N/A             │ Exported │
│ erTrackOutput                                                                                                                                                                                    │ Global  │ N/A    │ N/A             │ Exported │
│ riter                                                                                                                                                                                            │ Global  │ N/A    │ N/A             │ Exported │
│ terInputPixelBufferAdaptor                                                                                                                                                                       │ Global  │ N/A    │ N/A             │ Exported │
└──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┴─────────┴────────┴─────────────────┴──────────┘

Библиотеки
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┳━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Имя                                                                                             ┃ Тип              ┃ Флаги ┃ Путь                                        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━╇━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ /usr/lib/libc++.1.dylib                                                                         │ Системная        │ N/A   │ N/A                                         │
│ @rpath/libswiftAppKit.dylib                                                                     │ Пользовательская │ N/A   │ @rpath/libswiftAppKit.dylib                 │
│ /System/Library/Frameworks/SceneKit.framework/Versions/A/SceneKit                               │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/CoreMediaIO.framework/Versions/A/CoreMediaIO                         │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/Carbon.framework/Versions/A/Carbon                                   │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/WebKit.framework/Versions/A/WebKit                                   │ Системная        │ N/A   │ N/A                                         │
│ /usr/lib/libbz2.1.0.dylib                                                                       │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/MetalKit.framework/Versions/A/MetalKit                               │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/Metal.framework/Versions/A/Metal                                     │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/CoreSpotlight.framework/Versions/A/CoreSpotlight                     │ Системная        │ Weak  │ N/A                                         │
│ @rpath/Sparkle.framework/Versions/A/Sparkle                                                     │ Пользовательская │ Weak  │ @rpath/Sparkle.framework/Versions/A/Sparkle │
│ /System/Library/Frameworks/Contacts.framework/Versions/A/Contacts                               │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/QuartzCore.framework/Versions/A/QuartzCore                           │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/Security.framework/Versions/A/Security                               │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/VideoToolbox.framework/Versions/A/VideoToolbox                       │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/Accelerate.framework/Versions/A/Accelerate                           │ Системная        │ N/A   │ N/A                                         │
│ /usr/lib/libz.1.dylib                                                                           │ Системная        │ N/A   │ N/A                                         │
│ /usr/lib/libiconv.2.dylib                                                                       │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/AppKit.framework/Versions/C/AppKit                                   │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/LocalAuthentication.framework/Versions/A/LocalAuthentication         │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/CoreServices.framework/Versions/A/CoreServices                       │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/CoreVideo.framework/Versions/A/CoreVideo                             │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/CoreMedia.framework/Versions/A/CoreMedia                             │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/OpenGL.framework/Versions/A/OpenGL                                   │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/IOKit.framework/Versions/A/IOKit                                     │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/QuickLook.framework/Versions/A/QuickLook                             │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/JavaScriptCore.framework/Versions/A/JavaScriptCore                   │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/MapKit.framework/Versions/A/MapKit                                   │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/Quartz.framework/Versions/A/Quartz                                   │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/Foundation.framework/Versions/C/Foundation                           │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/AVFoundation.framework/Versions/A/AVFoundation                       │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/MediaPlayer.framework/Versions/A/MediaPlayer                         │ Системная        │ N/A   │ N/A                                         │
│ /usr/lib/libobjc.A.dylib                                                                        │ Системная        │ N/A   │ N/A                                         │
│ /usr/lib/libSystem.B.dylib                                                                      │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/AVKit.framework/Versions/A/AVKit                                     │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/ApplicationServices.framework/Versions/A/ApplicationServices         │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/AudioToolbox.framework/Versions/A/AudioToolbox                       │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/CFNetwork.framework/Versions/A/CFNetwork                             │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/CoreAudio.framework/Versions/A/CoreAudio                             │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/CoreFoundation.framework/Versions/A/CoreFoundation                   │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/CoreGraphics.framework/Versions/A/CoreGraphics                       │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/CoreImage.framework/Versions/A/CoreImage                             │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/CoreLocation.framework/Versions/A/CoreLocation                       │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/CoreText.framework/Versions/A/CoreText                               │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/IOSurface.framework/Versions/A/IOSurface                             │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/ImageIO.framework/Versions/A/ImageIO                                 │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/LinkPresentation.framework/Versions/A/LinkPresentation               │ Системная        │ Weak  │ N/A                                         │
│ /System/Library/Frameworks/MetalPerformanceShaders.framework/Versions/A/MetalPerformanceShaders │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/NaturalLanguage.framework/Versions/A/NaturalLanguage                 │ Системная        │ Weak  │ N/A                                         │
│ /System/Library/Frameworks/Network.framework/Versions/A/Network                                 │ Системная        │ Weak  │ N/A                                         │
│ /System/Library/Frameworks/PassKit.framework/Versions/A/PassKit                                 │ Системная        │ Weak  │ N/A                                         │
│ /System/Library/Frameworks/StoreKit.framework/Versions/A/StoreKit                               │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/SystemConfiguration.framework/Versions/A/SystemConfiguration         │ Системная        │ N/A   │ N/A                                         │
│ /System/Library/Frameworks/UserNotifications.framework/Versions/A/UserNotifications             │ Системная        │ Weak  │ N/A                                         │
│ /System/Library/Frameworks/Vision.framework/Versions/A/Vision                                   │ Системная        │ N/A   │ N/A                                         │
│ /usr/lib/libcompression.dylib                                                                   │ Системная        │ N/A   │ N/A                                         │
│ /usr/lib/swift/libswiftCompression.dylib                                                        │ Системная        │ Weak  │ N/A                                         │
│ /usr/lib/swift/libswiftCoreMIDI.dylib                                                           │ Системная        │ Weak  │ N/A                                         │
│ /usr/lib/swift/libswiftCoreML.dylib                                                             │ Системная        │ Weak  │ N/A                                         │
│ /usr/lib/swift/libswiftCoreMediaIO.dylib                                                        │ Системная        │ Weak  │ N/A                                         │
│ /usr/lib/swift/libswiftOSLog.dylib                                                              │ Системная        │ Weak  │ N/A                                         │
│ /usr/lib/swift/libswiftPassKit.dylib                                                            │ Системная        │ Weak  │ N/A                                         │
│ /usr/lib/swift/libswiftQuickLookUI.dylib                                                        │ Системная        │ Weak  │ N/A                                         │
│ /usr/lib/swift/libswiftUniformTypeIdentifiers.dylib                                             │ Системная        │ Weak  │ N/A                                         │
│ /usr/lib/swift/libswiftVideoToolbox.dylib                                                       │ Системная        │ Weak  │ N/A                                         │
│ /usr/lib/swift/libswiftWebKit.dylib                                                             │ Системная        │ Weak  │ N/A                                         │
│ @rpath/libswiftAVFoundation.dylib                                                               │ Пользовательская │ Weak  │ @rpath/libswiftAVFoundation.dylib           │
│ @rpath/libswiftAccelerate.dylib                                                                 │ Пользовательская │ Weak  │ @rpath/libswiftAccelerate.dylib             │
│ @rpath/libswiftCore.dylib                                                                       │ Пользовательская │ N/A   │ @rpath/libswiftCore.dylib                   │
│ @rpath/libswiftCoreAudio.dylib                                                                  │ Пользовательская │ N/A   │ @rpath/libswiftCoreAudio.dylib              │
│ @rpath/libswiftCoreFoundation.dylib                                                             │ Пользовательская │ N/A   │ @rpath/libswiftCoreFoundation.dylib         │
│ @rpath/libswiftCoreGraphics.dylib                                                               │ Пользовательская │ N/A   │ @rpath/libswiftCoreGraphics.dylib           │
│ @rpath/libswiftCoreImage.dylib                                                                  │ Пользовательская │ Weak  │ @rpath/libswiftCoreImage.dylib              │
│ @rpath/libswiftCoreLocation.dylib                                                               │ Пользовательская │ Weak  │ @rpath/libswiftCoreLocation.dylib           │
│ @rpath/libswiftCoreMedia.dylib                                                                  │ Пользовательская │ N/A   │ @rpath/libswiftCoreMedia.dylib              │
│ @rpath/libswiftDarwin.dylib                                                                     │ Пользовательская │ N/A   │ @rpath/libswiftDarwin.dylib                 │
│ @rpath/libswiftDispatch.dylib                                                                   │ Пользовательская │ N/A   │ @rpath/libswiftDispatch.dylib               │
│ @rpath/libswiftGLKit.dylib                                                                      │ Пользовательская │ Weak  │ @rpath/libswiftGLKit.dylib                  │
│ @rpath/libswiftIOKit.dylib                                                                      │ Пользовательская │ Weak  │ @rpath/libswiftIOKit.dylib                  │
│ @rpath/libswiftMapKit.dylib                                                                     │ Пользовательская │ Weak  │ @rpath/libswiftMapKit.dylib                 │
│ @rpath/libswiftMetal.dylib                                                                      │ Пользовательская │ Weak  │ @rpath/libswiftMetal.dylib                  │
│ @rpath/libswiftMetalKit.dylib                                                                   │ Пользовательская │ Weak  │ @rpath/libswiftMetalKit.dylib               │
│ @rpath/libswiftModelIO.dylib                                                                    │ Пользовательская │ Weak  │ @rpath/libswiftModelIO.dylib                │
│ @rpath/libswiftNaturalLanguage.dylib                                                            │ Пользовательская │ Weak  │ @rpath/libswiftNaturalLanguage.dylib        │
│ @rpath/libswiftObjectiveC.dylib                                                                 │ Пользовательская │ N/A   │ @rpath/libswiftObjectiveC.dylib             │
│ @rpath/libswiftQuartzCore.dylib                                                                 │ Пользовательская │ N/A   │ @rpath/libswiftQuartzCore.dylib             │
│ @rpath/libswiftSceneKit.dylib                                                                   │ Пользовательская │ N/A   │ @rpath/libswiftSceneKit.dylib               │
│ @rpath/libswiftVision.dylib                                                                     │ Пользовательская │ Weak  │ @rpath/libswiftVision.dylib                 │
│ @rpath/libswiftXPC.dylib                                                                        │ Пользовательская │ Weak  │ @rpath/libswiftXPC.dylib                    │
│ @rpath/libswiftos.dylib                                                                         │ Пользовательская │ Weak  │ @rpath/libswiftos.dylib                     │
│ @rpath/libswiftsimd.dylib                                                                       │ Пользовательская │ Weak  │ @rpath/libswiftsimd.dylib                   │
│ @rpath/libswiftFoundation.dylib                                                                 │ Пользовательская │ N/A   │ @rpath/libswiftFoundation.dylib             │
└─────────────────────────────────────────────────────────────────────────────────────────────────┴──────────────────┴───────┴─────────────────────────────────────────────┘
```

#### Преимущества для статического анализа

1. **Анализ зависимостей**
   - Быстрое определение всех используемых библиотек
   - Выявление подозрительных или нестандартных зависимостей
   - Анализ слабых ссылок, которые могут быть использованы для инъекций
   - Обнаружение реэкспортируемых библиотек, что может указывать на обфускацию

2. **Поиск уязвимых функций**
   - Автоматическое выявление небезопасных функций (strcpy, gets и т.д.)
   - Анализ потенциальных точек инъекции
   - Определение функций, связанных с отладкой и анти-отладкой
   - Выявление функций для работы с памятью, которые могут быть уязвимы

3. **Анализ экспортируемых символов**
   - Определение публичного API приложения
   - Поиск скрытых или недокументированных функций
   - Выявление потенциальных бэкдоров через экспортируемые функции
   - Анализ именования функций для определения их назначения

4. **Безопасность и обфускация**
   - Обнаружение техник обфускации через анализ символов
   - Выявление попыток скрытия функциональности
   - Анализ слабых символов, которые могут быть перехвачены
   - Определение приватных функций, которые могут содержать скрытую логику

5. **Отладка и анализ**
   - Быстрое определение точек входа в программу
   - Поиск функций, связанных с обработкой ошибок
   - Анализ цепочки вызовов функций
   - Определение критических участков кода



### Плагин анализа сетевой активности ``network_analyzer_plugin.py``

Плагин анализа сетевой активности является важным компонентом Mach-O Analyzer, который специализируется на выявлении и анализе сетевых функций и потенциальных угроз в Mach-O файлах. Этот анализатор необходим для оценки безопасности приложения и выявления подозрительной сетевой активности.


##### Сетевая активность в Mach-O файлах

Сетевая активность в Mach-O файлах может проявляться в различных формах:

1. **Сокеты**
   - Создание сетевых соединений
   - Прослушивание портов
   - Передача данных

2. **DNS операции**
   - Разрешение имен
   - Обратные запросы
   - Кэширование DNS

3. **HTTP/HTTPS**
   - Веб-запросы
   - API взаимодействия
   - Загрузка данных

4. **Специальные протоколы**
   - FTP
   - SMTP
   - SSH
   - Другие сетевые протоколы

#### Основной функционал ``network_analyzer_plugin.py``

1. **Анализ базовой информации**
   - Общее количество сетевых функций
   - Количество категорий сетевых операций
   - Общий уровень риска
   - Статистика использования

2. **Анализ сетевых функций**

   - **Сокеты**
     - socket, socketpair
     - accept, bind, connect
     - listen, send, recv
     - sendto, recvfrom

   - **DNS операции**
     - gethostbyname
     - gethostbyaddr
     - getaddrinfo
     - getnameinfo

   - **Передача данных**
     - send, sendto
     - recv, recvfrom
     - read, write

   - **Сетевой ввод/вывод**
     - select, poll
     - epoll, kqueue

   - **URL операции**
     - curl
     - NSURL
     - CFURL
     - URLSession

3. **Анализ URL и портов**

   - **URL анализ**
     - HTTP/HTTPS ссылки
     - Домены
     - Пути
     - Параметры

   - **Порты**
     - Номера портов
     - Стандартные порты
     - Нестандартные порты
     - Описание портов

4. **Оценка рисков**

   - **Уровни риска**
     - INFO (информационный)
     - WARNING (предупреждение)
     - CRITICAL (критический)

   - **Критерии оценки**
     - Количество функций
     - Типы операций
     - Используемые порты
     - URL активности

#### Преимущества для анализа безопасности

1. **Обнаружение вредоносной активности**
   - Подозрительные сетевые соединения
   - Нестандартные порты
   - Скрытые URL
   - DNS туннелирование

2. **Анализ утечек данных**
   - Несанкционированная передача
   - Небезопасные протоколы
   - Открытые порты
   - Уязвимые соединения

3. **Мониторинг сетевой активности**
   - Отслеживание соединений
   - Анализ трафика
   - Проверка протоколов
   - Оценка безопасности

4. **Оптимизация безопасности**
   - Рекомендации по защите
   - Улучшение конфигурации
   - Устранение уязвимостей
   - Усиление контроля

#### Вывод результатов
```
Основная информация о сетевой активности
┏━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Параметр          ┃ Значение              ┃
┡━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━┩
│ Сетевые функции   │ 8                     │
│ Сетевые категории │ 2                     │
│ Уровень риска     │ SeverityLevel.WARNING │
└───────────────────┴───────────────────────┘

Сетевые функции
┏━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Категория ┃ Функция       ┃ Описание                            ┃
┡━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ socket    │ socket        │ Создание сетевого сокета            │
│ socket    │ accept        │ Принятие входящего соединения       │
│ socket    │ bind          │ Привязка сокета к локальному адресу │
│ socket    │ connect       │ Подключение к удаленному хосту      │
│ socket    │ listen        │ Прослушивание входящих соединений   │
│ dns       │ gethostbyname │ Получение IP-адреса по имени хоста  │
│ dns       │ getaddrinfo   │ Получение информации об адресе      │
│ dns       │ getnameinfo   │ Получение имени хоста по IP-адресу  │
└───────────┴───────────────┴─────────────────────────────────────┘

Оценка рисков
┏━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Уровень               ┃ Причины                                                ┃ Рекомендации                              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ SeverityLevel.WARNING │ Обнаружено значительное количество сетевых функций (8) │ Рекомендуется проверка сетевой активности │
└───────────────────────┴────────────────────────────────────────────────────────┴───────────────────────────────────────────┘
```

### Плагин анализа встроенных данных ``embedded_data_analyzer_plugin.py``

Плагин предназначен для анализа встроенных данных в Mach-O файлах, включая строки, изображения, скрипты и другие типы данных.

#### Основные возможности

1. **Анализ базовой информации**:
   - Общее количество секций
   - Общее количество элементов данных
   - Общий размер встроенных данных

2. **Анализ по секциям**:
   - Имя секции
   - Смещение в файле
   - Размер секции
   - Список найденных данных

3. **Типы анализируемых данных**:
   - Строки (String)
   - Изображения (Image)
   - Скрипты (Script)
   - Конфигурации (Config)
   - Бинарные данные (Binary)
   - Зашифрованные данные (Encrypted)
   - Неизвестные данные (Unknown)

4. **Анализ чувствительных данных**:
   - Пароли и учетные данные
   - URL-адреса
   - Email-адреса
   - IP-адреса
   - Пути к файлам
   - API-ключи и токены

5. **Распознавание форматов файлов**:
   - PNG, JPEG, GIF, WEBP, BMP, TIFF
   - PDF, ZIP, RAR, 7ZIP, GZIP, BZIP2
   - DMG, ELF, Mach-O, DYLIB
   - ISO, Base64

6. **Анализ криптографических констант**:
   - AES S-box
   - SHA256 IV
   - MD5 IV
   - RSA экспонента
   - Blowfish PI
   - RC4 таблица
   - Serpent PHI
   - Twofish RS
   - Camellia SIGMA

7. **Анализ Objective-C секций**:
   - Методы (``__objc_methname``)
   - Имена классов (``__objc_classname``)
   - Чувствительные операции
   - Методы управления памятью

#### Пример вывода
```
Основная информация о встроенных данных
┏━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┓
┃ Параметр               ┃ Значение     ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━┩
│ Всего секций           │ 18           │
│ Всего элементов данных │ 20577        │
│ Общий размер           │ 1557530 байт │
└────────────────────────┴──────────────┘

Секция: __const
Смещение: 0x4719e46
Размер: 76258 байт
┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Тип                 ┃ Смещение  ┃ Размер ┃ Содержимое                                                ┃ Чувствительные данные ┃
┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━┩
│ Sensitive_password  │ 0x4719e46 │ 311    │ key:isOutgoing:connections:maxLayer:allowP2P:allow...     │ Нет                   │
│ Sensitive_password  │ 0x4719fbe │ 249    │ key:isOutgoing:connections:maxLayer:allowP2P:allow...     │ Нет                   │
│ Sensitive_password  │ 0x471a0f8 │ 281    │ key:isOutgoing:connections:maxLayer:allowP2P:allow...     │ Нет                   │
│ Sensitive_password  │ 0x471a252 │ 249    │ key:isOutgoing:connections:maxLayer:allowP2P:allow...     │ Нет                   │
│ Sensitive_password  │ 0x471a38c │ 249    │ key:isOutgoing:connections:maxLayer:allowP2P:allow...     │ Нет                   │
│ Sensitive_password  │ 0x471a4c6 │ 249    │ key:isOutgoing:connections:maxLayer:allowP2P:allow...     │ Нет                   │
│ Sensitive_password  │ 0x471a600 │ 358    │ key:isOutgoing:connections:maxLayer:allowP2P:allow...     │ Нет                   │
│ Sensitive_password  │ 0x471a7a7 │ 250    │ key:isOutgoing:connections:maxLayer:allowP2P:allow...     │ Нет                   │
│ Sensitive_password  │ 0x471a8e2 │ 248    │ key:isOutgoing:connections:maxLayer:allowP2P:allow...     │ Нет                   │
│
...
│ Sensitive_url       │ 0x471e7c6 │ 2470   │ http://www.ietf.org/id/draft-holmer-rmcat-transpor...     │ Нет                   │
│ Sensitive_url       │ 0x4721b96 │ 762    │ http://www.webrtc.org/experiments/rtp-hdrext/abs-s...     │ Нет                   │
│ Sensitive_url       │ 0x4776575 │ 26     │ http://www.w3.org/ns/ttml"                                │ Нет                   │
│ Sensitive_url       │ 0x4813a2f │ 104    │ http://crl.comodoca.com/AAACertificateServices.crl...     │ Нет                   │
│ Sensitive_url       │ 0x4813d5e │ 57     │ http://crl.comodoca.com/COMODOCertificationAuthori...     │ Нет                   │
│ Sensitive_url       │ 0x481c12d │ 1260   │ http://www.webrtc.org/experiments/rtp-hdrext/abs-c...     │ Нет                   │
│ Sensitive_url       │ 0x482bb1a │ 69     │ http://www.webrtc.org/experiments/rtp-hdrext/inban...     │ Нет                   │
│ Sensitive_ip        │ 0x480ef5c │ 7      │ 8.8.8.8                                                   │ Нет                   │
│ Sensitive_ip        │ 0x481e00c │ 9      │ 127.0.0.1                                                 │ Нет                   │
│ Sensitive_ip        │ 0x481e0f4 │ 7      │ 0.0.0.0                                                   │ Нет                   │
│ Sensitive_ip        │ 0x481e606 │ 7      │ 0.0.0.0                                                   │ Нет                   │
│ Sensitive_file_path │ 0x470c374 │ 4      │ /3.1                                                      │ Нет                   │
│ Sensitive_file_path │ 0x470c384 │ 4      │ /1.1                                                      │ Нет                   │
│ Sensitive_file_path │ 0x471e7cc │ 13     │ /www.ietf.org                                             │ Нет                   │
│ Sensitive_file_path │ 0x4721b9c │ 15     │ /www.webrtc.org                                           │ Нет                   │
│ Sensitive_file_path │ 0x475b082 │ 8      │ /__5DD.9                                                  │ Нет                   │
│ Sensitive_file_path │ 0x477526f │ 7      │ /vnd.ms                                                   │ Нет                   │
...
│ Sensitive_file_path │ 0x46d2724 │ 36     │ /0123456789efghijklmno.é½½ģøc½                            │ Нет                   │
│ Sensitive_file_path │ 0x47861cb │ 4      │ /P.S                                                      │ Нет                   │
│ Crypto_RSA_E        │ 0x4692b62 │ 3      │                                                            │ Нет                   │
│ Crypto_RC4_INIT     │ 0x471b630 │ 16     │                                                            │ Нет                   │
│                     │           │        │                                                           │                       │
│ Crypto_RSA_E        │ 0x4dac02a │ 3      │                                                            │ Нет                   │
│ Crypto_RC4_INIT     │ 0x4f834c0 │ 16     │                                                            │ Нет                   │
│                     │           │        │                                                           │                       │
└─────────────────────┴───────────┴────────┴───────────────────────────────────────────────────────────┴───────────────────────┘

Секция: __objc_methname
Смещение: 0x0
Размер: 649246 байт
┏━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Тип                ┃ Смещение  ┃ Размер ┃ Содержимое                                                                                              ┃ Чувствительные данные ┃
┡━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━┩
│ ObjC_method        │ 0x0       │ 125    │ EESV_PNS4_14TurnCustomizerEPNS7_22SSLCertificateVerifierEPKNS4_15FieldTrialsViewEE3$_2NSP_IS13_EEFvP... │ Нет                   │
│ Memory_method      │ 0x7e      │ 347    │ ZN7cricket8TurnPortC1EPN6webrtc13TaskQueueBaseEPN3rtc19PacketSocketFactoryEPKNS4_7NetworkEttNSt3__11... │ Нет                   │
│ ObjC_method        │ 0x1db     │ 6      │                                                                                                         │ Нет                   │
│                    │           │        │                                                                                                         │                       │
│                    │           │        │                                                                                                         │                       │
│ Memory_method      │ 0x1e2     │ 128    │ NSt3__110__function6__funcIZN7cricket8TurnPort22CreateTurnClientSocketEvE3$_4NS_9allocatorIS4_EEFvPN... │ Нет                   │
│ ObjC_method        │ 0x1fd     │ 50     │ ZN7cricket8TurnPort22CreateTurnClientSocketEvE3$_4                                                      │ Нет                   │
...
│ Sensitive_api_key  │ 0x4891a8b │ 31     │ Secret: T@"NSRegularExpression"                                                                          │ Нет                   │
└────────────────────┴───────────┴────────┴─────────────────────────────────────────────────────────────────────────────────────────────────────────┴───────────────────────┘

Секция: __swift5_typeref
Смещение: 0x48c9745
Размер: 18192 байт
┏━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Тип                ┃ Смещение  ┃ Размер ┃ Содержимое                                      ┃ Чувствительные данные ┃
┡━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━┩
│ Sensitive_password │ 0x48c9745 │ 9096   │ Key: uniforms unique uniqueID uniqueId uniqueKey u... │ Нет                   │
│ Sensitive_password │ 0x48c9745 │ 9096   │ Key: uniforms unique uniqueID uniqueId uniqueKey u... │ Нет                   │
└────────────────────┴───────────┴────────┴─────────────────────────────────────────────────┴───────────────────────┘

Секция: __cstring
Смещение: 0x14
Размер: 761368 байт
┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Тип                 ┃ Смещение  ┃ Размер ┃ Содержимое                                                                                              ┃ Чувствительные данные ┃
┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━┩
│ Encoded_data        │ 0x14      │ 39     │ So29OngoingGroupCallBroadcastPartCIegg_                                                                 │ Нет                   │
│ Encoded_data        │ 0xf8      │ 65     │ So44OngoingCallThreadLocalContextWebrtcVideoView_So6NSViewCXcSgXw                                       │ Нет                   │
│ Encoded_data        │ 0x222     │ 41     │ So29OngoingGroupCallBroadcastPartCSgIegg_                                                               │ Нет                   │
│ Encoded_data        │ 0x24c     │ 53     │ SaySo39OngoingGroupCallMediaChannelDescriptionCGIegg_                                                   │ Нет                   │
│ Encoded_data        │ 0x50a     │ 40     │ $s12TelegramVoip21SharedHLSServerSourceP                                                                │ Нет                   │
...
│ Crypto_RSA_E        │ 0x4af4a78 │ 3      │                                                        │ Нет                   │
└─────────────────────┴───────────┴────────┴───────────────────────────────────────────────────────┴───────────────────────┘

```
